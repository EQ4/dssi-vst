#!/bin/sh

# determine the app Winelib library name
appname=`basename "$0" .exe`.exe.so

# and app directory
appdir=""
case "$0" in
  */*)
    # $0 contains a path, use it
    appdir=`dirname "$0"`
    ;;
  *)
    # no directory in $0, search in PATH
    saved_ifs=$IFS
    IFS=:
    for d in $PATH
    do
      IFS=$saved_ifs
      if [ -x "$d/$0" ]; then appdir="$d"; break; fi
    done
    ;;
esac

export WINEDLLPATH="$appdir":$WINEDLLPATH

mkdir -p /tmp/$$
trap "rm -rf /tmp/$$" 0 1 2 3 15

(
  cd /tmp/$$
  ln -s "$appdir/$appname" "."
  wine "./$appname" "$@"
)

rm -rf /tmp/$$
exit

