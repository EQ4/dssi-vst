#!/bin/sh
#
# Wrapper script to start a Winelib application once it is installed
# Based on wineapploader, Copyright (C) 2002 Alexandre Julliard
# Modified to support starting application from same directory as
# this script

# determine the app Winelib library name
appname=`basename "$0" .exe`.exe

# and app directory
appdir=""
case "$0" in
  */*)
    # $0 contains a path, use it
    appdir=`dirname "$0"`
    ;;
  *)
    # no directory in $0, search in PATH
    saved_ifs=$IFS
    IFS=:
    for d in $PATH
    do
      IFS=$saved_ifs
      if [ -x "$d/$0" ]; then appdir="$d"; break; fi
    done
    ;;
esac

# allow Wine to load Winelib application from the current directory and app directory
export WINEDLLPATH=$WINEDLLPATH:"$appdir":.

# first try explicit WINELOADER
if [ -x "$WINELOADER" ]; then exec "$WINELOADER" "$appname" "$@"; fi

# then default bin directory
if [ -x "@bindir@/wine" ]; then exec "@bindir@/wine" "$appname" "$@"; fi

# now try the directory containing $0
if [ -x "$appdir/wine" ]; then exec "$appdir/wine" "$appname" "$@"; fi

# finally look in PATH
exec wine "$appname" "$@"
